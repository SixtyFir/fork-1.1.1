<script setup lang="ts">
import { ref } from 'vue';
import { useRouter } from 'vue-router';

const router = useRouter();


interface QuizQuestion {
  question: string;
  options: string[];
  correct: number;
}

interface SubLevel {
  id: string;
  title: string;
  tasks: string[];
  quiz?: QuizQuestion[];
}

interface Level {
  id: number;
  title: string;
  description: string;
  difficulty: string;
  estimatedTime: string;
  progress: number;
  locked: boolean;
  subLevels: SubLevel[];
}

const levels = ref<Level[]>([
  {
    id: 1,
    title: '–û—Å–Ω–æ–≤—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
    description: '–ò–∑—É—á–∏—Ç–µ –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è',
    difficulty: '–ù–∞—á–∞–ª—å–Ω—ã–π',
    estimatedTime: '5 –º–∏–Ω',
    progress: 0,
    locked: false,
    subLevels: [
      {
        id: '1.1',
        title: '–ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ?',
        tasks: [
          '–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ü–û',
          '–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
          '–†–æ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫–∞ –≤ –∫–æ–º–∞–Ω–¥–µ'
        ],
        quiz: [
          {
            question: '–ö–∞–∫–æ–≤–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ü–û?',
            options: [
              '–ù–∞–π—Ç–∏ –≤—Å–µ –±–∞–≥–∏',
              '–£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–æ–¥—É–∫—Ç–∞',
              '–ù–∞–ø–∏—Å–∞—Ç—å –º–Ω–æ–≥–æ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤',
              '–°–¥–µ–ª–∞—Ç—å –∫–æ–¥ –∏–¥–µ–∞–ª—å–Ω—ã–º'
            ],
            correct: 1
          }
        ]
      },
      {
        id: '1.2',
        title: '–í–∏–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
        tasks: [
          '–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ',
          '–ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ',
          '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã'
        ]
      }
    ]
  },
  {
    id: 2,
    title: '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API',
    description: '–û—Å–≤–æ–π—Ç–µ –æ—Å–Ω–æ–≤—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤',
    difficulty: '–°—Ä–µ–¥–Ω–∏–π',
    estimatedTime: '30 –º–∏–Ω',
    progress: 0,
    locked: true,
    subLevels: [
      {
        id: '2.1',
        title: '–û—Å–Ω–æ–≤—ã REST API',
        tasks: [
          'HTTP –º–µ—Ç–æ–¥—ã –∏ –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤',
          '–°—Ç—Ä—É–∫—Ç—É—Ä–∞ REST –∑–∞–ø—Ä–æ—Å–æ–≤',
          '–ü—Ä–∞–∫—Ç–∏–∫–∞ —Å Postman'
        ]
      },
      {
        id: '2.2',
        title: '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤',
        tasks: [
          '–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö',
          '–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π',
          '–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫'
        ]
      }
    ]
  },
  {
    id: 3,
    title: '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
    description: '–ò–∑—É—á–∏—Ç–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ –º–µ—Ç–æ–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
    difficulty: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π',
    estimatedTime: '45 –º–∏–Ω',
    progress: 0,
    locked: true,
    subLevels: [
      {
        id: '3.1',
        title: 'OWASP Top 10',
        tasks: [
          '–ò–∑—É—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π',
          '–ú–µ—Ç–æ–¥—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∞—Ç–∞–∫',
          '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã'
        ]
      },
      {
        id: '3.2',
        title: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API',
        tasks: [
          '–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è',
          '–ó–∞—â–∏—Ç–∞ –æ—Ç –∏–Ω—ä–µ–∫—Ü–∏–π',
          '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö'
        ]
      }
    ]
  },
  {
    id: 4,
    title: '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
    description: '–ù–∞—É—á–∏—Ç–µ—Å—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã',
    difficulty: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π',
    estimatedTime: '60 –º–∏–Ω',
    progress: 0,
    locked: true,
    subLevels: [
      {
        id: '4.1',
        title: '–û—Å–Ω–æ–≤—ã Selenium',
        tasks: [
          '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è',
          '–õ–æ–∫–∞—Ç–æ—Ä—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤',
          '–ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã'
        ]
      },
      {
        id: '4.2',
        title: '–§—Ä–µ–π–º–≤–æ—Ä–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è',
        tasks: [
          'Jest –∏ –µ–≥–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏',
          'Cypress –¥–ª—è E2E —Ç–µ—Å—Ç–æ–≤',
          '–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞'
        ]
      }
    ]
  }
]);

const selectedLevel = ref<Level | null>(null);

const selectLevel = (level: Level) => {
  if (!level.locked) {
    selectedLevel.value = level;
  }
};

const startQuiz = (levelId: number) => {
  router.push(`/quiz/${levelId}`);
};
</script>

<template>
  <div class="space-y-6">
    <div class="bg-white rounded-2xl shadow-lg p-6">
      <h2 class="text-2xl font-bold text-gray-800 mb-2">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ QA Learning</h2>
      <p class="text-gray-600">–û—Å–≤–æ–π—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</p>
    </div>

    <div class="grid gap-6">
      <div v-for="level in levels" :key="level.id" 
           class="bg-white rounded-2xl shadow-lg overflow-hidden"
           :class="{ 'opacity-75 cursor-not-allowed': level.locked }"
           @click="selectLevel(level)">
        <div class="h-32 bg-gradient-to-r from-blue-500 to-indigo-600 p-6">
          <div class="flex justify-between items-start">
            <h3 class="text-xl font-bold text-white">{{ level.title }}</h3>
            <span class="px-3 py-1 bg-white/20 text-white rounded-full text-sm">
              {{ level.difficulty }}
            </span>
          </div>
          <p class="text-blue-100 mt-2">{{ level.description }}</p>
        </div>
        <div class="p-6">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-2 text-gray-600">
              <span class="text-sm">–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è:</span>
              <span class="font-medium">{{ level.estimatedTime }}</span>
            </div>
            <div v-if="level.locked" class="flex items-center gap-2 text-gray-600">
              <span class="text-sm">üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</span>
            </div>
          </div>
          <div class="space-y-3 mb-4" v-if="selectedLevel?.id === level.id && !level.locked">
            <div v-for="subLevel in level.subLevels" :key="subLevel.id" 
                 class="bg-gray-50 p-4 rounded-xl">
              <h4 class="font-semibold text-gray-800 mb-2">{{ subLevel.title }}</h4>
              <ul class="list-disc list-inside space-y-1 text-gray-600 text-sm">
                <li v-for="task in subLevel.tasks" :key="task">{{ task }}</li>
              </ul>
            </div>
          </div>
          <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
            <div class="bg-blue-600 h-2 rounded-full" :style="{ width: level.progress + '%' }"></div>
          </div>
          <button 
            @click="startQuiz(level.id)"
            class="w-full py-2 px-4 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
            :disabled="level.locked"
          >
            {{ level.locked ? '–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —É—Ä–æ–≤–Ω–∏' : '–ù–∞—á–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</template>